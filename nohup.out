
/home/hwc/hwc/textcnn/model/LSTMC.py:66: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters().
  output, (h_n, c_n) = self.rnn(emb)
Loading data...
Loading data successfully!
cuda
train epoch: 0
loss_1:2.3579432964 loss_2:4.2443838120 loss_3:4.8868808746
Traceback (most recent call last):
  File "main.py", line 100, in <module>
    train(i)
  File "main.py", line 46, in train
    inputs, targets = inputs.cuda(), targets.cuda()
KeyboardInterrupt
Loading data...
Loading data successfully!
cuda
train epoch: 0
loss_1:2.3295900822 loss_2:4.2179946899 loss_3:4.9261546135
loss_1:0.4060858190 loss_2:1.8320351839 loss_3:2.8408026695
loss_1:0.2136348039 loss_2:1.0564603806 loss_3:2.0320754051
loss_1:0.1620719880 loss_2:0.7227892876 loss_3:1.4997196198
loss_1:0.2890607119 loss_2:0.7212266922 loss_3:1.3857203722
loss_1:0.0949216187 loss_2:0.5721027255 loss_3:1.2928966284
loss_1:0.0728667378 loss_2:0.4891642332 loss_3:1.0771055222
loss_1:0.1326312125 loss_2:0.4698722959 loss_3:1.0435991287
loss_1:0.0235009454 loss_2:0.3648982048 loss_3:0.9721091390
loss_1:0.0569628999 loss_2:0.4267243743 loss_3:0.7782516479
loss_1:0.0324125886 loss_2:0.3823544383 loss_3:0.8182339668
loss_1:0.0831957608 loss_2:0.4711122811 loss_3:0.8545026779
train epoch 0 finished
val epoch 0 finished
Save model...
Save model successfully!
final loss:99.4474561363
f1 for class1: 0.9524743982713041
f1 for class2: 0.819096077381488
f1 for class3: 0.7020321928043168
final f1: 0.7621955787241669
best_f1: 0.7621955787241669
train epoch: 1
loss_1:0.1308973432 loss_2:0.3705932200 loss_3:0.7281616926
loss_1:0.1034206003 loss_2:0.3570023477 loss_3:0.8840979934
loss_1:0.0773663595 loss_2:0.3611014783 loss_3:0.7966631055
loss_1:0.0439988188 loss_2:0.3145146370 loss_3:0.6902789474
loss_1:0.0823077932 loss_2:0.3110462129 loss_3:0.7091135383
loss_1:0.0416048057 loss_2:0.1671091765 loss_3:0.5209439993
loss_1:0.0220456216 loss_2:0.3232483864 loss_3:0.7798689604
loss_1:0.0449730270 loss_2:0.3772613704 loss_3:0.6624732018
loss_1:0.0588655919 loss_2:0.2880873084 loss_3:0.5511288047
loss_1:0.0677240565 loss_2:0.3717481494 loss_3:0.7333476543
loss_1:0.0253737904 loss_2:0.2156103402 loss_3:0.4352474213
loss_1:0.0333105810 loss_2:0.3522138596 loss_3:0.5382825732
train epoch 1 finished
val epoch 1 finished
Save model...
Save model successfully!
final loss:75.7499697172
f1 for class1: 0.9712706179005478
f1 for class2: 0.884196565566731
f1 for class3: 0.7784052151318137
final f1: 0.8294291605391623
best_f1: 0.8294291605391623
train epoch: 2
loss_1:0.0112650990 loss_2:0.2342951745 loss_3:0.5700546503
loss_1:0.0269712992 loss_2:0.2749793231 loss_3:0.5726765990
loss_1:0.0569450781 loss_2:0.1516975462 loss_3:0.4392643571
loss_1:0.0628292039 loss_2:0.2053842843 loss_3:0.4815586507
loss_1:0.0133316088 loss_2:0.2093645036 loss_3:0.4619976878
loss_1:0.1351292580 loss_2:0.3233306706 loss_3:0.6217059493
loss_1:0.0709643513 loss_2:0.2056302726 loss_3:0.5146433115
loss_1:0.0380775630 loss_2:0.2464436889 loss_3:0.5484214425
loss_1:0.0100449435 loss_2:0.2951399684 loss_3:0.6626250148
loss_1:0.0257321093 loss_2:0.2075206935 loss_3:0.4755651653
loss_1:0.0455418341 loss_2:0.2134686857 loss_3:0.5311623216
loss_1:0.0142695140 loss_2:0.3273220360 loss_3:0.6035148501
train epoch 2 finished
val epoch 2 finished
Save model...
Save model successfully!
final loss:72.5258229696
f1 for class1: 0.9725275107716476
f1 for class2: 0.892457754181011
f1 for class3: 0.7997468024896093
final f1: 0.8448381588252336
best_f1: 0.8448381588252336
train epoch: 3
loss_1:0.0317474008 loss_2:0.1421653926 loss_3:0.4929718375
loss_1:0.0947264507 loss_2:0.2655603290 loss_3:0.6037015319
loss_1:0.0072598066 loss_2:0.0788439661 loss_3:0.2965608537
loss_1:0.0526247285 loss_2:0.1549973786 loss_3:0.4487986267
loss_1:0.0202748198 loss_2:0.2882040739 loss_3:0.4925611913
loss_1:0.0074892235 loss_2:0.2481882274 loss_3:0.4917623103
loss_1:0.0955719128 loss_2:0.3144893348 loss_3:0.5787146688
loss_1:0.0045794984 loss_2:0.1419338435 loss_3:0.3632161021
loss_1:0.0162770469 loss_2:0.1892670691 loss_3:0.4624276459
loss_1:0.0713281631 loss_2:0.1507672369 loss_3:0.4805526733
loss_1:0.0570481382 loss_2:0.1671672463 loss_3:0.5255780816
loss_1:0.0200602990 loss_2:0.0930575430 loss_3:0.3034863472
train epoch 3 finished
val epoch 3 finished
Save model...
Save model successfully!
final loss:74.5302740901
f1 for class1: 0.9717294648703086
f1 for class2: 0.8879689899859794
f1 for class3: 0.8077807227401659
final f1: 0.8482320771269242
best_f1: 0.8482320771269242
train epoch: 4
loss_1:0.0131734749 loss_2:0.2001132667 loss_3:0.3664820790
loss_1:0.0624200590 loss_2:0.1429703385 loss_3:0.5419672132
loss_1:0.0762081742 loss_2:0.2194708437 loss_3:0.5324994922
loss_1:0.0442115813 loss_2:0.0842319578 loss_3:0.4576187134
loss_1:0.0427200571 loss_2:0.1029452309 loss_3:0.2285490781
loss_1:0.0500870049 loss_2:0.2034074068 loss_3:0.4807013571
loss_1:0.0236899145 loss_2:0.0923456252 loss_3:0.2998642921
loss_1:0.0222009830 loss_2:0.0961686224 loss_3:0.2148023695
loss_1:0.1189683601 loss_2:0.2015030682 loss_3:0.4344643056
loss_1:0.0544495806 loss_2:0.1572522521 loss_3:0.3259940147
loss_1:0.1753575653 loss_2:0.2053442150 loss_3:0.6780197024
loss_1:0.0575435832 loss_2:0.1637130827 loss_3:0.3678157330
train epoch 4 finished
val epoch 4 finished
Save model...
Save model successfully!
final loss:72.9859122325
f1 for class1: 0.9732558391616204
f1 for class2: 0.8924759731950451
f1 for class3: 0.815949709346542
final f1: 0.8546382014826007
best_f1: 0.8546382014826007
train epoch: 5
loss_1:0.0028181449 loss_2:0.1266458333 loss_3:0.2830985188
loss_1:0.0942917317 loss_2:0.2451586127 loss_3:0.4942435920
loss_1:0.0030415410 loss_2:0.1731524616 loss_3:0.4517784417
loss_1:0.0863177255 loss_2:0.2407226264 loss_3:0.4213970602
loss_1:0.0270892326 loss_2:0.1122523248 loss_3:0.3112065494
loss_1:0.0048613721 loss_2:0.1299291253 loss_3:0.2845903039
loss_1:0.0402615145 loss_2:0.1317287087 loss_3:0.3853106499
loss_1:0.0418658927 loss_2:0.0833532214 loss_3:0.3358477950
loss_1:0.0411750115 loss_2:0.1865094602 loss_3:0.4413073659
loss_1:0.1528679729 loss_2:0.3251332045 loss_3:0.4409302175
loss_1:0.0909143761 loss_2:0.2985711396 loss_3:0.5118831992
loss_1:0.0253460594 loss_2:0.3071268499 loss_3:0.4877139926
train epoch 5 finished
val epoch 5 finished
Save model...
Save model successfully!
final loss:78.9602402395
f1 for class1: 0.9710964772069328
f1 for class2: 0.8934357379773511
f1 for class3: 0.8176121592055287
final f1: 0.8557076646372158
best_f1: 0.8557076646372158
train epoch: 6
loss_1:0.0537555330 loss_2:0.0951421112 loss_3:0.2406487167
loss_1:0.0887895897 loss_2:0.1729344130 loss_3:0.3992196321
loss_1:0.0334594920 loss_2:0.0908922106 loss_3:0.3255476058
loss_1:0.0866031200 loss_2:0.2040257901 loss_3:0.4124304056
loss_1:0.0013258694 loss_2:0.0664425492 loss_3:0.4032134116
loss_1:0.0272519663 loss_2:0.1017937735 loss_3:0.2474106252
loss_1:0.0027028562 loss_2:0.2213052809 loss_3:0.3169955313
loss_1:0.0059625339 loss_2:0.1002865806 loss_3:0.2684729099
loss_1:0.0519269444 loss_2:0.1075184271 loss_3:0.2569158673
loss_1:0.0039075557 loss_2:0.1566244066 loss_3:0.4569976926
loss_1:0.0055109770 loss_2:0.0989123881 loss_3:0.2368482053
loss_1:0.0801439434 loss_2:0.0909443051 loss_3:0.3473045230
train epoch 6 finished
val epoch 6 finished
Save model...
Save model successfully!
final loss:78.3678085385
f1 for class1: 0.9707306274241736
f1 for class2: 0.8969743055186707
f1 for class3: 0.8203268898133032
final f1: 0.8583614882860005
best_f1: 0.8583614882860005
train epoch: 7
loss_1:0.0289105866 loss_2:0.0916311517 loss_3:0.2701607049
loss_1:0.0173571967 loss_2:0.1600591391 loss_3:0.4303255379
loss_1:0.0615687519 loss_2:0.1588380188 loss_3:0.3063877523
loss_1:0.0122754816 loss_2:0.0664451569 loss_3:0.2926862240
loss_1:0.0242677368 loss_2:0.0496200435 loss_3:0.2386860996
loss_1:0.0051881364 loss_2:0.1024221927 loss_3:0.3337258697
loss_1:0.0015383682 loss_2:0.0873455256 loss_3:0.4042952955
loss_1:0.0519197695 loss_2:0.1588868946 loss_3:0.3681103587
loss_1:0.0235121679 loss_2:0.0868158117 loss_3:0.1840090156
loss_1:0.0020707189 loss_2:0.1776911616 loss_3:0.4456470311
loss_1:0.1001626477 loss_2:0.1678089350 loss_3:0.4011635482
loss_1:0.0617462620 loss_2:0.1436484903 loss_3:0.5050583482
train epoch 7 finished
val epoch 7 finished
final loss:82.7086742524
f1 for class1: 0.9725159368994893
f1 for class2: 0.8923489791514098
f1 for class3: 0.8173296788220541
final f1: 0.8553540947286044
best_f1: 0.8583614882860005
train epoch: 8
loss_1:0.0014669378 loss_2:0.1073936298 loss_3:0.2743704617
loss_1:0.0015652666 loss_2:0.1453307569 loss_3:0.2125297785
loss_1:0.0161918476 loss_2:0.1088448316Loading data...
Loading data successfully!
cuda
train epoch: 0
loss_1:2.3870928288 loss_2:4.1879892349 loss_3:4.9367952347
loss_1:0.4061445594 loss_2:1.9880050421 loss_3:2.9210469723
loss_1:0.3178602755 loss_2:1.1178406477 loss_3:2.0116741657
loss_1:0.2326271236 loss_2:0.8987321854 loss_3:1.6035208702
loss_1:0.1079108119 loss_2:0.6007735133 loss_3:1.2114101648
loss_1:0.1015674770 loss_2:0.5257282257 loss_3:1.1372865438
loss_1:0.0527859628 loss_2:0.4087856114 loss_3:1.0684930086
loss_1:0.0618345775 loss_2:0.4139750898 loss_3:1.0053232908
loss_1:0.0569608472 loss_2:0.4131809771 loss_3:0.8250612617
loss_1:0.0325036906 loss_2:0.2876274884 loss_3:0.6750939488
loss_1:0.0830744952 loss_2:0.4057834744 loss_3:0.9003845453
loss_1:0.0782233849 loss_2:0.3100616634 loss_3:0.7084375024
train epoch 0 finished
val epoch 0 finished
Save model...
Save model successfully!
final loss:99.1250918126
f1 for class1: 0.9632215999864554
f1 for class2: 0.8382468211934413
f1 for class3: 0.7063928877821944
final f1: 0.7716319390259947
best_f1: 0.7716319390259947
train epoch: 1
loss_1:0.0759669095 loss_2:0.3577119708 loss_3:0.7215277553
loss_1:0.0403653383 loss_2:0.2759560347 loss_3:0.6576845050
loss_1:0.1101839393 loss_2:0.3096325696 loss_3:0.5407168269
loss_1:0.0531064458 loss_2:0.2035966665 loss_3:0.5261090994
loss_1:0.0465820655 loss_2:0.4114452302 loss_3:0.7043517828
loss_1:0.0314486064 loss_2:0.2995679677 loss_3:0.6013184190
loss_1:0.0421555452 loss_2:0.2253199965 loss_3:0.5794396996
loss_1:0.1110916957 loss_2:0.2609852552 loss_3:0.6565745473
loss_1:0.0905359760 loss_2:0.4799692631 loss_3:0.8064694405
loss_1:0.0984833986 loss_2:0.3981296420 loss_3:0.7696080804
loss_1:0.0323821418 loss_2:0.2856689394 loss_3:0.5551113486
loss_1:0.0539381802 loss_2:0.3465053737 loss_3:0.6796708703
train epoch 1 finished
val epoch 1 finished
Save model...
Save model successfully!
final loss:83.4787222650
f1 for class1: 0.9712088651460913
f1 for class2: 0.8498628322616131
f1 for class3: 0.7694482394860135
final f1: 0.8137486798847011
best_f1: 0.8137486798847011
train epoch: 2
loss_1:0.0435631424 loss_2:0.3084824383 loss_3:0.5661247373
loss_1:0.0613720417 loss_2:0.2070873380 loss_3:0.4570813179
loss_1:0.0384478942 loss_2:0.2649659514 loss_3:0.5346585512
loss_1:0.0657758266 loss_2:0.3108749986 loss_3:0.6674966812
loss_1:0.1153548360 loss_2:0.4785999358 loss_3:0.7491225004
loss_1:0.0465783402 loss_2:0.1803440750 loss_3:0.4560841918
loss_1:0.0472510830 loss_2:0.3297853470 loss_3:0.5727081895
loss_1:0.0641181096 loss_2:0.2001231015 loss_3:0.4493160844
loss_1:0.0397977121 loss_2:0.3902329206 loss_3:0.8847062588
loss_1:0.0916351229 loss_2:0.3507668674 loss_3:0.5922047496
loss_1:0.0190601293 loss_2:0.2226243913 loss_3:0.4299339652
loss_1:0.0451029241 loss_2:0.1420900077 loss_3:0.4867689312
train epoch 2 finished
val epoch 2 finished
Save model...
Save model successfully!
final loss:78.4433052852
f1 for class1: 0.972361778089522
f1 for class2: 0.8808860286809883
f1 for class3: 0.797256545861036
final f1: 0.8398559139298702
best_f1: 0.8398559139298702
train epoch: 3
loss_1:0.0382864624 loss_2:0.2032456994 loss_3:0.4834656417
loss_1:0.1026464552 loss_2:0.2182645351 loss_3:0.5888037682
loss_1:0.0454122424 loss_2:0.2096887231 loss_3:0.4449953735
loss_1:0.0427279174 loss_2:0.1315370202 loss_3:0.3425014019
loss_1:0.0409860201 loss_2:0.2082595080 loss_3:0.4451714456
loss_1:0.0077414690 loss_2:0.1796776354 loss_3:0.3504444659
loss_1:0.0494082756 loss_2:0.1898728162 loss_3:0.3894433081
loss_1:0.1263436824 loss_2:0.2268610299 loss_3:0.5677852035
loss_1:0.0574282408 loss_2:0.4191753566 loss_3:0.6428567767
loss_1:0.0124843270 loss_2:0.1100795269 loss_3:0.3044595122
loss_1:0.0088071059 loss_2:0.2617603242 loss_3:0.5323429704
loss_1:0.0388716348 loss_2:0.1545001566 loss_3:0.5452369452
train epoch 3 finished
val epoch 3 finished
Save model...
Save model successfully!
final loss:74.7613673395
f1 for class1: 0.9726258273885747
f1 for class2: 0.8867204012083789
f1 for class3: 0.8050914699948417
final f1: 0.846333585098276
best_f1: 0.846333585098276
train epoch: 4
loss_1:0.0114635918 loss_2:0.2344481498 loss_3:0.5213818550
loss_1:0.0348080546 loss_2:0.1584719867 loss_3:0.5524736047
loss_1:0.0055165924 loss_2:0.1160298586 loss_3:0.4547981024
loss_1:0.0150259240 loss_2:0.0588334277 loss_3:0.3057107925
loss_1:0.0334630609 loss_2:0.0731296614 loss_3:0.2319631577
loss_1:0.0121257799 loss_2:0.1803554595 loss_3:0.4780248404
loss_1:0.0120150754 loss_2:0.1603043973 loss_3:0.4531086385
loss_1:0.0153642856 loss_2:0.1970700175 loss_3:0.3741861880
loss_1:0.0084649511 loss_2:0.1600710303 loss_3:0.5072540641
loss_1:0.0623254329 loss_2:0.2269020826 loss_3:0.4652406275
loss_1:0.0569799244 loss_2:0.1969278604 loss_3:0.3270615041
loss_1:0.0255709011 loss_2:0.1303263456 loss_3:0.3210395575
train epoch 4 finished
val epoch 4 finished
Save model...
Save model successfully!
final loss:73.7540069236
f1 for class1: 0.9738613164236003
f1 for class2: 0.8950257501590423
f1 for class3: 0.81466388843124
final f1: 0.8546921897488167
best_f1: 0.8546921897488167
train epoch: 5
loss_1:0.0075151576 loss_2:0.0779780969 loss_3:0.1912821680
loss_1:0.0231131166 loss_2:0.1433423311 loss_3:0.3722933829
loss_1:0.1231756955 loss_2:0.2550839782 loss_3:0.4602038860
loss_1:0.0822609067 loss_2:0.1490951478 loss_3:0.5363687873
loss_1:0.0253489055 loss_2:0.2727364004 loss_3:0.4025059938
loss_1:0.0110125262 loss_2:0.1078242213 loss_3:0.3133512735
loss_1:0.1009222418 loss_2:0.2276796103 loss_3:0.4540198147
loss_1:0.0128849084 loss_2:0.0707454085 loss_3:0.3311032355
loss_1:0.0361505710 loss_2:0.2079042494 loss_3:0.4732433856
loss_1:0.0560357459 loss_2:0.1349339038 loss_3:0.3556207418
loss_1:0.0394228473 loss_2:0.2008534074 loss_3:0.4050916135
loss_1:0.0034857444 loss_2:0.1053551063 loss_3:0.6078643203
train epoch 5 finished
val epoch 5 finished
Save model...
Save model successfully!
final loss:75.6369516732
f1 for class1: 0.9759365040417111
f1 for class2: 0.8951220904306358
f1 for class3: 0.8169923359358645
final f1: 0.8563256790948806
best_f1: 0.8563256790948806
train epoch: 6
loss_1:0.0142732663 loss_2:0.0741739199 loss_3:0.1602496207
loss_1:0.0752751380 loss_2:0.3276713789 loss_3:0.5151802897
loss_1:0.0651262030 loss_2:0.1052448153 loss_3:0.2146857381
loss_1:0.0045324052 loss_2:0.1572133750 loss_3:0.3986333907
loss_1:0.0202442240 loss_2:0.1552273482 loss_3:0.4892266095
loss_1:0.1257194728 loss_2:0.3195200264 loss_3:0.5145432353
loss_1:0.0651355460 loss_2:0.1146568358 loss_3:0.2011739761
loss_1:0.0039799707 loss_2:0.1194718331 loss_3:0.2577721477
loss_1:0.0446961299 loss_2:0.1098076627 loss_3:0.2946807742
loss_1:0.0004244377 loss_2:0.0721996725 loss_3:0.2220667005
loss_1:0.0112524573 loss_2:0.1034943759 loss_3:0.2400795221
loss_1:0.0609176308 loss_2:0.1763222516 loss_3:0.3600466251
train epoch 6 finished
val epoch 6 finished
final loss:80.1382565279
f1 for class1: 0.9746119153127928
f1 for class2: 0.8895716856918414
f1 for class3: 0.8133967873669521
final f1: 0.8523707696590029
best_f1: 0.8563256790948806
train epoch: 7
loss_1:0.0008429664 loss_2:0.0350972600 loss_3:0.2105097622
loss_1:0.0037110960 loss_2:0.1706844568 loss_3:0.5106375813
loss_1:0.0072311554 loss_2:0.1487810910 loss_3:0.3388768137
loss_1:0.0040138392 loss_2:0.1735698581 loss_3:0.3620325923
loss_1:0.0041630440 loss_2:0.0376557261 loss_3:0.1569479406
loss_1:0.0998317599 loss_2:0.1819094419 loss_3:0.3274597526
loss_1:0.0515102521 loss_2:0.2018722445 loss_3:0.3363003731
loss_1:0.0106619298 loss_2:0.1058491394 loss_3:0.3394851685
loss_1:0.0106621031 loss_2:0.1574771255 loss_3:0.3612285554
loss_1:0.0262318254 loss_2:0.1214067191 loss_3:0.3295796514
loss_1:0.0138173979 loss_2:0.0811541677 loss_3:0.2228012979
loss_1:0.0497782342 loss_2:0.1193096116 loss_3:0.3398430645
train epoch 7 finished
val epoch 7 finished
Save model...
Save model successfully!
final loss:81.3969344767
f1 for class1: 0.9743379792900908
f1 for class2: 0.8954016948705018
f1 for class3: 0.8191022273674597
final f1: 0.8575156428106354
best_f1: 0.8575156428106354
train epoch: 8
loss_1:0.0021722419 loss_2:0.0504049361 loss_3:0.1984155923
loss_1:0.0047632474 loss_2:0.1073050648 loss_3:0.2766228914
loss_1:0.0154265277 loss_2:0.0940220952